const t=async(t,n)=>{const r=new URLSearchParams({response_type:"code",client_id:t.client_id,redirect_uri:t.redirect_uri}),i=await fetch(`${n}/oauth/authorize?${r.toString()}`);return await i.json()},n=async(t,n)=>{const r=document.createElement("form");r.method="POST",r.action=`${n}/oauth/verify-signature`,r.style.display="none";const i=document.createElement("input");i.type="hidden",i.name="payload",i.value=t,r.appendChild(i),document.body.appendChild(r),r.submit()};
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function r(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function i(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function e(t,...n){if(!r(t))throw new Error("Uint8Array expected");if(n.length>0&&!n.includes(t.length))throw new Error("Uint8Array expected of length "+n+", got length="+t.length)}function s(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")}function o(t,n){e(t);const r=n.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function h(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function c(...t){for(let n=0;n<t.length;n++)t[n].fill(0)}function u(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function f(t,n){return t<<n|t>>>32-n>>>0}function a(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function l(t){for(let n=0;n<t.length;n++)t[n]=a(t[n]);return t}const w=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])()?t=>t:l;function d(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}function y(t){return"string"==typeof t&&(t=d(t)),e(t),t}class g{}function A(t){const n=n=>t().update(y(n)).digest(),r=t();return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=()=>t(),n}function p(t,n,r,i){if("function"==typeof t.setBigUint64)return t.setBigUint64(n,r,i);const e=BigInt(32),s=BigInt(4294967295),o=Number(r>>e&s),h=Number(r&s),c=i?4:0,u=i?0:4;t.setUint32(n+c,o,i),t.setUint32(n+u,h,i)}class b extends g{constructor(t,n,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(t),this.view=u(this.buffer)}update(t){s(this),e(t=y(t));const{view:n,buffer:r,blockLen:i}=this,o=t.length;for(let e=0;e<o;){const s=Math.min(i-this.pos,o-e);if(s===i){const n=u(t);for(;i<=o-e;e+=i)this.process(n,e);continue}r.set(t.subarray(e,e+s),this.pos),this.pos+=s,e+=s,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){s(this),o(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:e}=this;let{pos:h}=this;n[h++]=128,c(this.buffer.subarray(h)),this.padOffset>i-h&&(this.process(r,0),h=0);for(let t=h;t<i;t++)n[t]=0;p(r,i-8,BigInt(8*this.length),e),this.process(r,0);const f=u(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,w=this.get();if(l>w.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<l;t++)f.setUint32(4*t,w[t],e)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}t(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:e,destroyed:s,pos:o}=this;return t.destroyed=s,t.finished=e,t.length=i,t.pos=o,i%n&&t.buffer.set(r),t}clone(){return this.t()}}const B=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),U=(()=>Uint8Array.from(new Array(16).fill(0).map((t,n)=>n)))(),E=(()=>U.map(t=>(9*t+5)%16))(),I=(()=>{const t=[[U],[E]];for(let n=0;n<4;n++)for(let r of t)r.push(r[n].map(t=>B[t]));return t})(),F=(()=>I[0])(),x=(()=>I[1])(),L=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>Uint8Array.from(t)),m=F.map((t,n)=>t.map(t=>L[n][t])),k=x.map((t,n)=>t.map(t=>L[n][t])),C=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),N=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function D(t,n,r,i){return 0===t?n^r^i:1===t?n&r|~n&i:2===t?(n|~r)^i:3===t?n&i|r&~i:n^(r|~i)}const M=new Uint32Array(16);class _ extends b{constructor(){super(64,20,8,!0),this.h0=1732584193|0,this.h1=4023233417|0,this.h2=2562383102|0,this.h3=271733878|0,this.h4=3285377520|0}get(){const{h0:t,h1:n,h2:r,h3:i,h4:e}=this;return[t,n,r,i,e]}set(t,n,r,i,e){this.h0=0|t,this.h1=0|n,this.h2=0|r,this.h3=0|i,this.h4=0|e}process(t,n){for(let r=0;r<16;r++,n+=4)M[r]=t.getUint32(n,!0);let r=0|this.h0,i=r,e=0|this.h1,s=e,o=0|this.h2,h=o,c=0|this.h3,u=c,a=0|this.h4,l=a;for(let t=0;t<5;t++){const n=4-t,w=C[t],d=N[t],y=F[t],g=x[t],A=m[t],p=k[t];for(let n=0;n<16;n++){const i=f(r+D(t,e,o,c)+M[y[n]]+w,A[n])+a|0;r=a,a=c,c=0|f(o,10),o=e,e=i}for(let t=0;t<16;t++){const r=f(i+D(n,s,h,u)+M[g[t]]+d,p[t])+l|0;i=l,l=u,u=0|f(h,10),h=s,s=r}}this.set(this.h1+o+u|0,this.h2+c+l|0,this.h3+a+i|0,this.h4+r+s|0,this.h0+e+h|0)}roundClean(){c(M)}destroy(){this.destroyed=!0,c(this.buffer),this.set(0,0,0,0,0)}}const O=A(()=>new _),P=BigInt(2**32-1),v=BigInt(32);function S(t,n=!1){return n?{h:Number(t&P),l:Number(t>>v&P)}:{h:0|Number(t>>v&P),l:0|Number(t&P)}}function T(t,n=!1){const r=t.length;let i=new Uint32Array(r),e=new Uint32Array(r);for(let s=0;s<r;s++){const{h:r,l:o}=S(t[s],n);[i[s],e[s]]=[r,o]}return[i,e]}const H=(t,n,r)=>t<<r|n>>>32-r,X=(t,n,r)=>n<<r|t>>>32-r,$=(t,n,r)=>n<<r-32|t>>>64-r,R=(t,n,r)=>t<<r-32|n>>>64-r,V=BigInt(0),z=BigInt(1),G=BigInt(2),J=BigInt(7),K=BigInt(256),Q=BigInt(113),W=[],Y=[],Z=[];for(let t=0,n=z,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],W.push(2*(5*i+r)),Y.push((t+1)*(t+2)/2%64);let e=V;for(let t=0;t<7;t++)n=(n<<z^(n>>J)*Q)%K,n&G&&(e^=z<<(z<<BigInt(t))-z);Z.push(e)}const j=T(Z,!0),q=j[0],tt=j[1],nt=(t,n,r)=>r>32?$(t,n,r):H(t,n,r),rt=(t,n,r)=>r>32?R(t,n,r):X(t,n,r);function it(t,n=24){const r=new Uint32Array(5*2);for(let i=24-n;i<24;i++){for(let n=0;n<10;n++)r[n]=t[n]^t[n+10]^t[n+20]^t[n+30]^t[n+40];for(let n=0;n<10;n+=2){const i=(n+8)%10,e=(n+2)%10,s=r[e],o=r[e+1],h=nt(s,o,1)^r[i],c=rt(s,o,1)^r[i+1];for(let r=0;r<50;r+=10)t[n+r]^=h,t[n+r+1]^=c}let n=t[2],e=t[3];for(let r=0;r<24;r++){const i=Y[r],s=nt(n,e,i),o=rt(n,e,i),h=W[r];n=t[h],e=t[h+1],t[h]=s,t[h+1]=o}for(let n=0;n<50;n+=10){for(let i=0;i<10;i++)r[i]=t[n+i];for(let i=0;i<10;i++)t[n+i]^=~r[(i+2)%10]&r[(i+4)%10]}t[0]^=q[i],t[1]^=tt[i]}c(r)}class et extends g{constructor(t,n,r,e=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=e,this.rounds=s,i(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=h(this.state)}clone(){return this.t()}keccak(){w(this.state32),it(this.state32,this.rounds),w(this.state32),this.posOut=0,this.pos=0}update(t){s(this),e(t=y(t));const{blockLen:n,state:r}=this,i=t.length;for(let e=0;e<i;){const s=Math.min(n-this.pos,i-e);for(let n=0;n<s;n++)r[this.pos++]^=t[e++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:i}=this;t[r]^=n,128&n&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){s(this,!1),e(t),this.finish();const n=this.state,{blockLen:r}=this;for(let i=0,e=t.length;i<e;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,e-i);t.set(n.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return i(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(o(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,c(this.state)}t(t){const{blockLen:n,suffix:r,outputLen:i,rounds:e,enableXOF:s}=this;return t||(t=new et(n,r,i,s,e)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=e,t.suffix=r,t.outputLen=i,t.enableXOF=s,t.destroyed=this.destroyed,t}}const st=(t,n,r)=>A(()=>new et(n,t,r)),ot=(()=>st(6,136,256/8))(),ht=t=>0===t.length?new Uint8Array:new Uint8Array(t.match(/.{1,2}/g).map(t=>parseInt(t,16))),ct=t=>Array.from(t,t=>t.toString(16).padStart(2,"0")).join(""),ut="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",ft=t=>{let n=0,r=0,i="";for(const e of ht(t))for(r=r<<8|e,n+=8;n>=5;)i+=ut[r>>>n-5&31],n-=5;return n>0&&(i+=ut[r<<5-n&31]),i},at=t=>{let n=0,r=0,i="";for(const e of t)for(r=r<<5|ut.indexOf(e),n+=5;n>=8;)i+=(r>>>n-8&255).toString(16).padStart(2,"0"),n-=8;return i.toUpperCase()},lt=(t,n)=>{const r=O(ot(ht(n))),i=new Uint8Array([t,...r]),e=ot(i).slice(0,3);return ft(ct(new Uint8Array([...i,...e])))},wt="76E94661562762111FF7E592B00398554973396D8A4B922F3E3D139892F7C35C",dt="BE0B4CF546B7B4F4BBFCFF9F574FDA527C07A53D3FC76F8BB7DB746F8E8E0A9F",yt=t=>"mainnet"===t?104:152,gt=(t,n)=>{const r=yt(t),i=(160+n.length).toString(16).padStart(8,"0").toUpperCase(),e=i.match(/.{2}/g)?.reverse().join(""),s="00000000",o="0".repeat(128),h="0".repeat(64),c="00000000",u="01",f=r.toString(16).padStart(2,"0").toUpperCase(),a=16724..toString(16).padStart(4,"0").match(/.{2}/g).reverse().join("").toUpperCase(),l="0".repeat(16),w="0".repeat(16),d=at(lt(r,"testnet"===t?wt:dt)),y="00",g="00",A="00000000",p=(new TextEncoder).encode(n);return e+s+o+h+c+u+f+a+l+w+d+p.length.toString(16).padStart(4,"0").toUpperCase().match(/.{2}/g).reverse().join("")+g+A+y+Array.from(p,t=>t.toString(16).padStart(2,"0")).join("").toUpperCase()},At=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);export{gt as createSignTx,t as getChallenge,At as isMobileDevice,n as verifySignature};
//# sourceMappingURL=symbol-sign-on.mjs.map
